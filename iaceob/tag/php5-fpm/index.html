<!doctype html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/favicon.svg"> <title>php5-fpm - 生物烯丙菊</title> <link rel="stylesheet" href="/css/style.css"> </head> <body> <header class="head"> <h1 class="head-title"><a href="/">生物烯丙菊</a></h1> <h3 class="head-description"> <span class="flashlight">达文西手电筒</span> </h3> <ul class="head-nav"> <li><a href="/">Home</a></li> <li><a href="/archives/">Archives</a></li> <li><a href="http://blog.3u3.me">幾文山</a></li> </ul> </header> <main class="main"> <article class="post"> <header class="post-head"> <time datetime="2014-11-12T00:35:32.000Z">November 12, 2014</time> <h1><a href="/post/nginx-php-php-fpm-configure/">Nginx php php-fpm 配置</a></h1> </header> <section class="post-main"><p> </p> <p>Debian/Ubuntu 中安装 nginx php 并进行配置</p> <p>安装很简单。 使用 apt-get 进行安装即可</p> <pre>~$ sudo apt-get install nginx
# 根据需要选择 php 插件
~$ sudo apt-get install php5 php5-cli php5-cgi php5-dev php5-mysql php5-gd php5-mcrypt php5-curl</pre> <p>这样 nginx 和 php 就装好了。<br/> 接着安装 fastcgi 管理模块。<br/> nginx采用fastcgi的模式运行php，一般有两种搭配<br/> ngix + php+ spawn-fcgi<br/> ngix + php + PHP-FPM(主流)<br/> 如果选择spawn-fcgi来管理fastcgi</p> <pre>~$ sudo apt-get install spawn-fcgi</pre> <p>如果选择php-fpm来管理fastcgi</p> <pre>~$ sudo apt-get install php5-fpm</pre> <p>当这些都安装完毕后就对其进行配置<br/> 相关配置文件路径(默认情况下):<br/> nginx:<br/> /etc/nginx/nginx.conf<br/> /etc/nginx/sites-enabled/*<br/> # 之前有说过看 nginx.conf 文件就能看到还有那些地方可以配置</p> <p>php:<br/> /etc/php5/cgi/php.ini<br/> /usr/bin/php5-cgi</p> <p>php-fpm:<br/> /etc/php5/fpm/pool.d/www.conf</p> <p>配置 nginx 支持 php</p> <p>直接修改配置文件中的 default 配置<br/> /etc/nginx/sites-enabled/default</p> <p>修改根路径</p> <pre>root /home/xxx/wwwroot;</pre> <p>在 server { } 中添加</p> <pre>location ~ \.php$ {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }</pre> <p>这样就配置完成了。<br/> 重启 nginx 即可。</p> <p>=====<br/> 如果出现访问 php 报 http 502 Bad Gateway<br/> 首先检测 php5-fpm 是否正在运行</p> <pre>ps aux | grep php</pre> <p>如果没有则卸载重装<br/> 之后修改 php5-fpm 配置</p> <pre>sudo nano /etc/php5/fpm/pool.d/www.conf</pre> <p>找到</p> <pre>listen = /var/run/php5-fpm.sock</pre> <p>修改为</p> <pre>listen = 127.0.0.1:9000</pre> <p>重启 php5-fpm</p> <pre>sudo service php5-fpm restart</pre> <p>或者不修改 php5-fpm 的配置， 在 nginx 配置 php 的时候 fastcgi_pass 的值是 /var/run/php5-fpm.sock 即可， 只要保证俩边的配置一样。</p></section> <footer class="post-foot"> <ul class="post-tags"> <li><a href="/tag/nginx/">nginx</a></li> <li><a href="/tag/php/">php</a></li> <li><a href="/tag/php5-fpm/">php5-fpm</a></li> </ul> </footer> </article> <menu class="page"> </menu> </main> <footer class="foot"> <div>&copy;2017 iaceob</div> </footer> </body> </html>